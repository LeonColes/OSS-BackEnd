# OSS企业级文件存储系统 - 设计文档

## 1. 系统概述

OSS企业级文件存储系统是基于Web的企业级数据存储管理平台，提供用户群组、项目管理、文件版本控制和权限管理功能。系统采用React + Ant Design作为前端技术栈，Go + Gin + GORM作为后端框架，MinIO提供对象存储服务。

### 核心特性

- 多级权限控制与身份认证
- 群组与项目管理
- 文件版本控制与历史追踪
- 文件共享与协作编辑
- 强大的搜索与分类功能
- 系统监控与资源统计

## 2. 登录与注册模块

### 2.1 登录页面设计

**组件与布局:**
- 使用Ant Design 5.24+的Card组件作为登录表单容器
- 左侧为品牌区域，右侧为登录表单
- 采用Form、Input、Button等组件构建登录表单

**Ant Design组件实现:**
- Form表单：控制整体表单行为和验证
- Input.Password：带眼睛图标的密码输入框
- Checkbox：实现"记住我"功能
- Button：提交按钮，使用type="primary"和block属性
- Divider：分隔线，用于分隔登录和注册入口

**登录逻辑实现:**
- 表单验证: 使用Form组件的内置验证功能
- 登录请求: 使用Axios 1.8+调用API `/api/oss/user/login`
- 登录成功处理: 使用Zustand存储JWT令牌，重定向到仪表板页面
- 错误处理: 使用message组件显示登录失败消息

### 2.2 注册页面设计

**组件与布局:**
- 使用与登录页相似的布局
- 注册表单包含更多字段：邮箱、用户名、密码、确认密码

**注册表单验证:**
- 邮箱：必填且格式正确
- 密码：长度至少8位，包含大小写字母、数字和特殊字符
- 确认密码：必须与密码一致

## 3. 仪表板与统计分析

### 3.1 仪表板布局设计

**整体布局:**
- 使用Layout组件构建页面框架
- Sider作为左侧导航栏，Content作为主内容区
- Header包含用户信息和全局搜索

**主要组件:**
- Layout.Sider：左侧导航栏，默认为收缩状态，收缩宽度为60
- Layout.Header：顶部标题栏，包含页面标题和用户操作区
- Layout.Content：主内容区，包含统计卡片和数据图表，插入一个路由，由路由引导页面
- Menu：导航菜单，使用light主题

### 3.2 统计卡片设计

**统计卡片布局:**
- 使用Row和Col组件实现响应式网格布局
- 每个统计卡片使用Card和Statistic组件
- 采用不同图标和颜色区分不同类型的统计数据，使用@ant-design/icons 6.0+图标库

**数据图表组件:**
- 存储使用趋势：使用Ant Design Charts或其他兼容React 19的图表库
- 文件类型分布：使用饼图组件，展示不同类型文件的占比
- 用户活跃度：使用柱状图组件，展示用户活动统计

### 3.3 最近活动列表

**列表设计:**
- 使用List组件展示最近操作记录
- 每个列表项包含操作类型、操作对象、操作人和时间
- 不同操作类型使用不同图标和颜色标识

**API接口:**
- 获取最近文件：使用Axios 1.8+请求GET `/api/oss/file/recent`
- 获取活动日志：GET `/api/oss/log/recent`
- 获取统计数据：GET `/api/oss/stats/overview`

## 4. 群组管理模块

### 4.1 群组列表页面

**布局设计:**
- 顶部区域：包含页面标题、搜索框和创建按钮
- 中部区域：群组列表，使用Table或Card组件展示
- 底部区域：分页控件

**Ant Design组件实现:**
- PageHeader：页面标题和创建按钮
- Table：群组列表表格，含名称、描述、成员数、存储用量等列
- Space：操作按钮组布局
- Tag：显示群组状态，使用不同颜色区分
- Dropdown：更多操作菜单
- Modal：创建/编辑群组的弹窗表单

### 4.2 群组创建/编辑弹窗

**表单设计:**
- 使用Modal组件作为弹窗容器
- Form组件构建表单，包含名称、描述、标识码等字段
- 使用Form.Item的rules属性实现表单验证

**表单字段:**
- 群组名称：Input组件，必填字段
- 群组描述：TextArea组件，可选字段
- 群组标识(GroupKey)：Input组件，必填且仅允许字母数字
- 状态选择：Select组件，仅编辑模式可用

### 4.3 群组详情页面

**页面布局:**
- 顶部：PageHeader组件，显示群组名称和操作按钮
- 信息区：Descriptions组件，显示群组基本信息
- 统计区：Statistic组件，显示成员数、项目数和存储用量
- 标签页：Tabs组件，包含成员、项目、设置等标签页

**成员管理标签页:**
- 成员列表：Table组件，显示成员信息和角色
- 角色管理：Select组件，用于修改成员角色
- 邀请功能：邀请链接生成和复制功能

### 4.4 邀请管理功能

**邀请码生成:**
- Button触发邀请码生成
- Input.Group结合Button实现复制功能
- Alert组件显示邀请链接及使用说明

**邀请设置:**
- DatePicker设置有效期
- Select选择权限角色
- Checkbox设置其他选项

## 5. 项目管理模块

### 5.1 项目列表页面

**列表样式:**
- 使用Card网格布局或Table表格布局
- 列表项显示项目名称、描述、文件数量、存储用量等信息
- 操作区包含查看文件、管理成员、设置等按钮

**筛选功能:**
- 使用Select组件选择群组筛选器
- 使用Input.Search组件实现关键词搜索
- 使用Select组件选择项目状态筛选

### 5.2 项目创建表单

**表单字段:**
- 项目名称：Input组件，必填字段
- 项目描述：TextArea组件，可选字段
- 所属群组：Select组件，必填字段
- 访问权限：Radio.Group组件，选择项目默认权限

### 5.3 项目成员管理

**成员列表:**
- Table组件显示成员列表
- 角色列使用Select组件，支持修改角色
- 操作列包含移除成员按钮

**添加成员功能:**
- Select组件搜索群组成员
- Select组件选择角色
- DatePicker组件设置权限过期时间

## 6. 文件管理模块

### 6.1 文件浏览器设计

**布局结构:**
- 左侧：树形文件夹导航，使用Tree组件
- 右侧：文件列表，支持列表视图和网格视图
- 顶部：操作栏，包含上传、新建文件夹、视图切换等按钮
- 底部：分页和文件统计信息

**文件列表模式:**
- 列表视图：使用Table组件，显示详细信息
- 网格视图：使用List+Card组件，以缩略图方式显示
- 排序功能：支持按名称、大小、时间等字段排序

### 6.2 文件上传组件

**上传功能:**
- Upload组件实现文件上传，支持拖拽上传
- Progress组件显示上传进度
- 支持批量上传和文件夹上传
- 上传前文件检查（类型、大小限制）

**上传交互:**
- 上传前显示确认对话框（覆盖模式确认）
- 上传过程中显示进度条
- 上传完成后显示结果通知
- 上传失败时显示错误信息和重试选项

### 6.3 文件操作功能

**文件操作菜单:**
- Dropdown组件实现下拉操作菜单
- Menu组件定义菜单项：下载、分享、历史版本、删除等
- Modal组件实现各操作的确认弹窗
- message组件提供操作反馈

**文件分享功能:**
- Modal显示分享设置表单
- Input.Password设置访问密码
- DatePicker设置过期时间
- InputNumber设置下载次数限制
- 复制分享链接功能

### 6.4 文件版本历史

**版本列表:**
- Table组件显示版本历史列表
- 列包括版本号、大小、上传者、更新时间、注释等
- 操作列包含查看、恢复、下载按钮

**版本对比:**
- 仅适用于文本文件
- 使用适配React 19的diff组件展示版本差异
- 支持行号显示和高亮变更内容

## 7. 用户与权限管理模块

### 7.1 用户管理界面

**用户列表:**
- Table组件显示用户列表
- 列包括用户名、邮箱、状态、角色、最后登录时间等
- 筛选功能：按状态、角色、注册时间等筛选
- 搜索功能：按名称或邮箱搜索用户

**用户详情/编辑:**
- Form表单编辑用户信息
- Transfer组件分配角色权限
- 密码重置功能
- 账户状态管理（启用/禁用）

### 7.2 角色权限管理

**角色列表:**
- Table组件显示角色列表
- 列包括角色名称、描述、成员数等
- 操作列包含编辑、删除按钮
- 系统内置角色不可删除（显示锁定图标）

**权限配置:**
- Tree组件展示权限树
- Checkbox进行多选权限分配
- 按模块分组权限项
- 权限依赖关系处理（上级权限自动勾选下级）

## 8. 系统设置模块

### 8.1 系统参数设置

**界面设计:**
- Tabs组件分类不同设置项
- Form组件构建设置表单
- 不同类型设置使用相应表单控件

**存储设置:**
- InputNumber设置默认配额限制
- Select选择存储清理策略
- Checkbox设置自动备份选项
- Slider调整性能参数

### 8.2 安全设置

**密码策略:**
- Form.Item配置密码复杂度要求
- InputNumber设置密码有效期
- Radio.Group选择登录失败处理策略
- Checkbox设置启用二次验证选项

**访问控制:**
- TextArea配置IP白名单/黑名单
- Select设置会话超时时间
- Checkbox设置单点登录选项
- TimePicker设置访问时间限制

## 9. 移动端适配方案

### 9.1 响应式设计

**布局适配:**
- 使用Ant Design 5.24+的Grid组件实现响应式布局
- Media Query处理不同屏幕尺寸
- 小屏幕自动折叠侧边菜单
- 调整组件大小和间距适应触摸操作

**导航设计:**
- 小屏幕使用Drawer组件替代固定侧边栏
- 底部TabBar导航替代顶部菜单
- 简化操作流程，减少层级嵌套

### 9.2 触摸交互优化

**触摸操作:**
- 增大可点击区域，适应手指触摸
- 滑动手势替代部分点击操作
- 避免悬浮操作，改为长按触发
- 适配虚拟键盘弹出状态

## 10. 技术实现细节

### 10.1 前端技术栈

**核心框架:**
- React 19.0.0：最新的UI渲染核心框架
- Ant Design 5.24.8：UI组件库
- React Router 7.5.2：路由管理
- Zustand 5.0.3：轻量级状态管理
- Axios 1.8.4：HTTP请求客户端
- @ant-design/icons 6.0.0：图标库

**构建工具:**
- Vite：开发服务器和构建工具
- ESLint：代码检查
- Prettier：代码格式化
- TypeScript：类型检查

### 10.2 数据流管理

**Zustand状态管理:**
- 简洁高效的状态管理方案，基于hooks的API
- 模块化store设计：按功能领域拆分store
  - useAuthStore：认证状态、用户信息、权限信息
  - useGroupStore：群组列表、当前选中群组
  - useProjectStore：项目列表、当前选中项目
  - useFileStore：文件列表、文件操作状态
  - useUIStore：界面状态、主题设置、本地化

**异步数据处理:**
- 使用Zustand中间件或async/await处理异步操作
- 请求-加载-成功/失败三阶段状态管理
- 全局加载状态和错误处理
- 数据缓存和刷新策略

### 10.3 性能优化

**代码分割:**
- React.lazy和Suspense实现代码分割
- 路由级别的组件懒加载
- 大型组件库按需导入
- 第三方库独立打包

**渲染优化:**
- React 19的并发特性和自动批处理
- memo避免不必要的重渲染
- 虚拟列表处理大量数据展示
- 图片懒加载和WebP格式支持
- 组件级缓存和计算结果缓存

### 10.4 安全措施

**前端安全:**
- XSS防护：React自动转义渲染内容
- CSRF防护：请求头添加CSRF Token
- 敏感信息处理：不在前端存储敏感数据
- 输入验证：前端表单验证配合后端验证
- 权限检查：前端UI根据权限动态调整，后端API严格校验权限 